package pers.kelvin.util.json;

import com.jayway.jsonpath.DocumentContext;
import org.junit.Test;

import static org.testng.Assert.*;

public class JsonPathUtilTest {
    @Test
    public void jsonPathTest() {
        String jsonText = "{\"rspCd\":\"00000\",\"rspInf\":\"success\",\"rspType\":0,\"data\":[{\"signObject\":12,\"renewState\":10,\"contractNo\":\"HT201811281067714499160571904\",\"contractName\":\"APP Pay\",\"version\":0,\"settlement\":10,\"refundCharge\":11,\"refundState\":11,\"contractServiceList\":[{\"serviceType\":14,\"ruleType\":10,\"deductFee\":0.5,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":0.5,\"minDeductFee\":0.01}]},{\"signObject\":12,\"renewState\":10,\"contractNo\":\"HT201812191075317458295848960\",\"contractName\":\"企业\",\"version\":0,\"settlement\":10,\"refundCharge\":11,\"refundState\":10,\"contractServiceList\":[{\"serviceType\":12,\"ruleType\":10,\"deductFee\":0.5,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":0.5,\"minDeductFee\":0.01},{\"serviceType\":11,\"ruleType\":10,\"deductFee\":0.5,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":0.5,\"minDeductFee\":0.01},{\"serviceType\":10,\"ruleType\":10,\"deductFee\":0.5,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":0.5,\"minDeductFee\":0.01}]},{\"signObject\":12,\"renewState\":10,\"contractNo\":\"HT201904181118701968345268224\",\"contractName\":\"企业付款合同\",\"version\":0,\"settlement\":10,\"refundCharge\":11,\"refundState\":10,\"contractServiceList\":[{\"serviceType\":15,\"ruleType\":10,\"deductFee\":0.5,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":0.5,\"minDeductFee\":0.01},{\"serviceType\":12,\"ruleType\":10,\"deductFee\":0.5,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":0.5,\"minDeductFee\":0.01},{\"serviceType\":11,\"ruleType\":10,\"deductFee\":0.5,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":0.5,\"minDeductFee\":0.01},{\"serviceType\":10,\"ruleType\":10,\"deductFee\":0.5,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":0.5,\"minDeductFee\":0.01}]},{\"signObject\":12,\"renewState\":10,\"contractNo\":\"HT201904111116182333385342976\",\"contractName\":\"测试企业付款开户\",\"version\":1,\"settlement\":10,\"refundCharge\":11,\"refundState\":10,\"contractServiceList\":[{\"serviceType\":12,\"ruleType\":10,\"deductFee\":1.05,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":1,\"minDeductFee\":1},{\"serviceType\":11,\"ruleType\":10,\"deductFee\":1.05,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":1,\"minDeductFee\":1},{\"serviceType\":10,\"ruleType\":10,\"deductFee\":1.05,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":1,\"minDeductFee\":1},{\"serviceType\":15,\"ruleType\":10,\"deductFee\":1.05,\"version\":\"0\",\"currency\":\"USD\",\"poundageRule\":10,\"maxDeductFee\":1,\"minDeductFee\":1},{\"serviceType\":12,\"ruleType\":10,\"deductFee\":1,\"version\":\"0\",\"currency\":\"KHR\",\"poundageRule\":10,\"maxDeductFee\":1,\"minDeductFee\":1},{\"serviceType\":11,\"ruleType\":10,\"deductFee\":1,\"version\":\"0\",\"currency\":\"KHR\",\"poundageRule\":10,\"maxDeductFee\":1,\"minDeductFee\":1},{\"serviceType\":10,\"ruleType\":10,\"deductFee\":1,\"version\":\"0\",\"currency\":\"KHR\",\"poundageRule\":10,\"maxDeductFee\":1,\"minDeductFee\":1},{\"serviceType\":15,\"ruleType\":10,\"deductFee\":1,\"version\":\"0\",\"currency\":\"KHR\",\"poundageRule\":10,\"maxDeductFee\":1,\"minDeductFee\":1}]}],\"v\":\"1\",\"responseTm\":\"20190614145835\"}";
        DocumentContext ctx = JsonPathUtil.jsonParse(jsonText);
        int length = ctx.read("$.data.length()");
        String result = ctx.read("$.data[?(@.contractNo=='HT201904111116182333385342976')].contractNo");
        System.out.println(result);
    }

}